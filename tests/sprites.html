<!DOCTYPE html>
<html>
    <head>
        <title>Sprites</title>
    </head>

    <body>
        <canvas id="can"></canvas>
        <script type="module">
            import util from '../src/util.js'
            // import Shapes from '../src/Shapes.js'
            import World from '../src/World.js'
            import SpriteSheet from '../src/SpriteSheet.js'
            util.toWindow({ util, World, SpriteSheet })

            const patchSize = 4
            const world = new World({
                minX: 0,
                maxX: 200,
                minY: -50,
                maxY: 50,
            })
            const [size, theta] = [10, util.radians(45)]
            const pixels = size * patchSize

            const can = document.getElementById('can')
            const ctx = can.getContext('2d')
            const sheet = new SpriteSheet(size * patchSize, 16, false)
            const shapes = sheet.shapes
            util.toWindow({ shapes, sheet, can, ctx })

            // world.setCtxTransform(ctx, patchSize)
            // shapes.resetCtx(ctx, patchSize, width, height, x0, y0) // util?
            util.fillCtx(ctx, 'lightgray')

            async function addImages() {
                await shapes.imagePathPromise('tweet', './data/twitter.png')
                // console.log(shapes.getPath('tweet'))
                await shapes.imagePathPromise('redfish', './data/redfish.png')
                // console.log(shapes.getPath('redfish'))
            }
            addImages().then(() => {
                shapes.getPathNames().forEach((name, i) => {
                    sheet.newSprite(name, 'red', 'orange')
                    sheet.newSprite(name, 'gray', 'red')
                    sheet.newSprite(name, 'blue', 'black')
                })
                const htmlsheet = util.cloneCanvas(sheet.ctx.canvas, false)
                document.body.appendChild(htmlsheet)
            })
        </script>
    </body>
</html>
