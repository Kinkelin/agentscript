<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Adding meta -->
    

    <!-- Adding external script-->
    

    <!-- Adding external style-->
    

    <!-- Adding scripts-->
    

    <!-- Adding style-->
    

    <!-- Adding overlay script-->
    

    <!-- Adding overlay style-->
    


    <title>World.js</title>

    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/third-party/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/third-party/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-base.css">
    <link type="text/css" rel="stylesheet" href="styles/clean-jsdoc-theme-light.css">
    
<svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none">
    <defs>
        <symbol id="copy-icon" viewbox="0 0 488.3 488.3">
            <g>
                <path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/>
                <path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/>
            </g>
        </symbol>
    </defs>
</svg>

</head>
<body>
<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html"><div class="text">Home</div></a></h2><div class="search-box"><input type="text" placeholder="Search..." id="search-box" /><div class="search-item-container" id="search-item-container"><ul class="search-item-ul" id="search-item-ul"></ul></div></div><div class="sidebar-list-div"><h3>Tutorials</h3><ul><li class="" id=""><a href="tutorial-01-HelloModel.html">01-HelloModel</a></li><li class="" id=""><a href="tutorial-02-HelloHtml.html">02-HelloHtml</a></li><li class="" id=""><a href="tutorial-03-HelloServer.html">03-HelloServer</a></li><li class="" id=""><a href="tutorial-04-HelloView.html">04-HelloView</a></li><li class="" id=""><a href="tutorial-JavaScript.html">JavaScript</a></li></ul><h3>Classes</h3><ul><li class="accordion collapsed" id=9974638><div class="accordion-title"><a href="AgentArray.html">AgentArray</a><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
    <path 
        fill-rule="evenodd" 
        clip-rule="evenodd" 
        d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z">
    </path>
</svg></div><ul class='methods accordion-content'><li data-type='method'><a href="AgentArray.html#.fromArray">fromArray</a></li><li data-type='method'><a href="AgentArray.html#all">all</a></li><li data-type='method'><a href="AgentArray.html#ask">ask</a></li><li data-type='method'><a href="AgentArray.html#atIndex">atIndex</a></li><li data-type='method'><a href="AgentArray.html#clone">clone</a></li><li data-type='method'><a href="AgentArray.html#first">first</a></li><li data-type='method'><a href="AgentArray.html#forLoop">forLoop</a></li><li data-type='method'><a href="AgentArray.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="AgentArray.html#last">last</a></li><li data-type='method'><a href="AgentArray.html#props">props</a></li><li data-type='method'><a href="AgentArray.html#sortBy">sortBy</a></li><li data-type='method'><a href="AgentArray.html#toArray">toArray</a></li><li data-type='method'><a href="AgentArray.html#typedSample">typedSample</a></li><li data-type='method'><a href="AgentArray.html#uniq">uniq</a></li><li data-type='method'><a href="AgentArray.html#with">with</a></li></ul></li><li class="accordion collapsed" id=412684><div class="accordion-title"><a href="AgentSet.html">AgentSet</a><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
    <path 
        fill-rule="evenodd" 
        clip-rule="evenodd" 
        d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z">
    </path>
</svg></div><ul class='methods accordion-content'><li data-type='method'><a href="AgentSet.html#addAgent">addAgent</a></li><li data-type='method'><a href="AgentSet.html#ask">ask</a></li><li data-type='method'><a href="AgentSet.html#askSet">askSet</a></li><li data-type='method'><a href="AgentSet.html#clear">clear</a></li><li data-type='method'><a href="AgentSet.html#getDefault">getDefault</a></li><li data-type='method'><a href="AgentSet.html#isBaseSet">isBaseSet</a></li><li data-type='method'><a href="AgentSet.html#isBreedSet">isBreedSet</a></li><li data-type='method'><a href="AgentSet.html#newBreed">newBreed</a></li><li data-type='method'><a href="AgentSet.html#protoMixin">protoMixin</a></li><li data-type='method'><a href="AgentSet.html#removeAgent">removeAgent</a></li><li data-type='method'><a href="AgentSet.html#setBreed">setBreed</a></li><li data-type='method'><a href="AgentSet.html#setDefault">setDefault</a></li><li data-type='method'><a href="AgentSet.html#withBreed">withBreed</a></li></ul></li><li class="accordion collapsed" id=6624656><div class="accordion-title"><a href="DataSet.html">DataSet</a><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
    <path 
        fill-rule="evenodd" 
        clip-rule="evenodd" 
        d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z">
    </path>
</svg></div><ul class='methods accordion-content'><li data-type='method'><a href="DataSet.html#.emptyDataSet">emptyDataSet</a></li></ul></li><li class="" id=""><a href="Link.html">Link</a></li><li class="" id=""><a href="Links.html">Links</a></li><li class="accordion collapsed" id=825353><div class="accordion-title"><a href="Model.html">Model</a><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
    <path 
        fill-rule="evenodd" 
        clip-rule="evenodd" 
        d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z">
    </path>
</svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Model.html#linkBreeds">linkBreeds</a></li><li data-type='method'><a href="Model.html#patchBreeds">patchBreeds</a></li><li data-type='method'><a href="Model.html#reset">reset</a></li><li data-type='method'><a href="Model.html#setup">setup</a></li><li data-type='method'><a href="Model.html#startup">startup</a></li><li data-type='method'><a href="Model.html#step">step</a></li><li data-type='method'><a href="Model.html#tick">tick</a></li><li data-type='method'><a href="Model.html#turtleBreeds">turtleBreeds</a></li></ul></li><li class="" id=""><a href="Patch.html">Patch</a></li><li class="accordion collapsed" id=3114228><div class="accordion-title"><a href="Patches.html">Patches</a><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
    <path 
        fill-rule="evenodd" 
        clip-rule="evenodd" 
        d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z">
    </path>
</svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Patches.html#exportDataSet">exportDataSet</a></li><li data-type='method'><a href="Patches.html#importDataSet">importDataSet</a></li><li data-type='method'><a href="Patches.html#neighbors">neighbors</a></li><li data-type='method'><a href="Patches.html#neighbors4">neighbors4</a></li><li data-type='method'><a href="Patches.html#patchIndex">patchIndex</a></li></ul></li><li class="" id=""><a href="Turtle.html">Turtle</a></li><li class="accordion collapsed" id=3890896><div class="accordion-title"><a href="Turtles.html">Turtles</a><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
    <path 
        fill-rule="evenodd" 
        clip-rule="evenodd" 
        d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z">
    </path>
</svg></div><ul class='methods accordion-content'><li data-type='method'><a href="Turtles.html#addAgent">addAgent</a></li><li data-type='method'><a href="Turtles.html#ask">ask</a></li><li data-type='method'><a href="Turtles.html#askSet">askSet</a></li><li data-type='method'><a href="Turtles.html#clear">clear</a></li><li data-type='method'><a href="Turtles.html#getDefault">getDefault</a></li><li data-type='method'><a href="Turtles.html#inPatches">inPatches</a></li><li data-type='method'><a href="Turtles.html#isBaseSet">isBaseSet</a></li><li data-type='method'><a href="Turtles.html#isBreedSet">isBreedSet</a></li><li data-type='method'><a href="Turtles.html#newBreed">newBreed</a></li><li data-type='method'><a href="Turtles.html#protoMixin">protoMixin</a></li><li data-type='method'><a href="Turtles.html#removeAgent">removeAgent</a></li><li data-type='method'><a href="Turtles.html#setBreed">setBreed</a></li><li data-type='method'><a href="Turtles.html#setDefault">setDefault</a></li><li data-type='method'><a href="Turtles.html#withBreed">withBreed</a></li></ul></li><li class="accordion collapsed" id=7449389><div class="accordion-title"><a href="World.html">World</a><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
    <path 
        fill-rule="evenodd" 
        clip-rule="evenodd" 
        d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z">
    </path>
</svg></div><ul class='methods accordion-content'><li data-type='method'><a href="World.html#.defaultOptions">defaultOptions</a></li><li data-type='method'><a href="World.html#.defaultWorld">defaultWorld</a></li><li data-type='method'><a href="World.html#bboxTransform">bboxTransform</a></li><li data-type='method'><a href="World.html#isOnWorld">isOnWorld</a></li><li data-type='method'><a href="World.html#random3DPoint">random3DPoint</a></li><li data-type='method'><a href="World.html#randomPatchPoint">randomPatchPoint</a></li><li data-type='method'><a href="World.html#randomPoint">randomPoint</a></li></ul></li></ul></div>
</nav>

<div id="main">
    
    <h1 id='page-title' class="page-title">World.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import * as util from './utils.js'

// class World defines the coordinate system for the model.
// It will be  upgraded with methods converting from other
// transforms like  GIS and DataSets.

// const defaultZ = (maxX, maxY) => Math.max(maxX, maxY)

/**
 * @private
 * @typedef {Object} WorldOptions
 * @property {number} minX Max world patch x integer value
 * @property {number} minY Max world patch y integer value
 * @property {number} minZ Max world patch z integer value
 * @property {number} maxX Min world patch x integer value
 * @property {number} maxY Min world patch y integer value
 * @property {number} maxZ Min world patch z integer value
 */

/**
 * @description
 * Class World defines the coordinate system for the model.
 * It has transforms for multiple coordinate systems.
 *
 * The world is defined by an object with 6 properties:
 *
 *          WorldOptions = {
 *              minX: integer,
 *              maxX: integer,
 *              minY: integer,
 *              maxY: integer,
 *              minZ: integer,
 *              maxZ: integer,
 *          }
 */
class World {
    maxX = 16
    maxY = 16
    maxZ = 16
    minX = -16
    minY = -16
    minZ = -16

    /**
     * Create a new World object given an Object with optional
     * minX, maxX, minY, maxY, minZ, maxZ overriding class properties.
     * @param {World|WorldOptions|Object} options Object with overrides for class properties
     */
    constructor(options = {}) {
        Object.assign(this, options) // set the option override values
        this.setWorld() // convert these to rest of world parameters
    }

    // Until class properties universally, this approach is used:
    // setClassProperties() {
    //     this.maxX = 16
    //     this.maxY = 16
    //     this.maxZ = 16
    //     this.minX = -this.maxX
    //     this.minY = -this.maxY
    //     this.minZ = -this.maxZ
    // }

    /**
     * Return a default options object, origin at center.
     *
     * @param {number} [maxX=16] Integer max X value
     * @param {number} [maxY=maxX] Integer max Y value
     * @param {number} [maxZ=Math.max(maxX, maxY)] Integer max Z value
     * @return {WorldOptions}
     */
    static defaultOptions(maxX = 16, maxY = maxX, maxZ = Math.max(maxX, maxY)) {
        return {
            minX: -maxX,
            maxX: maxX,
            minY: -maxY,
            maxY: maxY,
            minZ: -maxZ,
            maxZ: maxZ,
        }
    }
    /**
     * Factory to create a default World instance.
     *
     * @param {number} [maxX=16] Integer max X value
     * @param {number} [maxY=maxX] Integer max Y value
     * @param {number} [maxZ=Math.max(maxX, maxY)] Integer max Z value
     * @return {World}
     */
    static defaultWorld(maxX = 16, maxY = maxX, maxZ = maxX) {
        return new World(World.defaultOptions(maxX, maxY, maxZ))
    }

    // ======================

    setWorld() {
        // Complete properties derived from minX/Y, maxX/Y (patchSize === 1)

        let { minX, maxX, minY, maxY, minZ, maxZ } = this

        util.forLoop({ minX, maxX, minY, maxY, minZ, maxZ }, (val, key) => {
            if (!Number.isInteger(val))
                throw Error(`${key}:${val} must be an integer`)
        })

        this.numX = this.width = maxX - minX + 1
        this.numY = this.height = maxY - minY + 1
        // if (maxZ == null) maxZ = this.maxZ = Math.max(this.width, this.height)
        this.numZ = this.depth = maxZ - minZ + 1

        this.minXcor = minX - 0.5
        this.maxXcor = maxX + 0.5
        this.minYcor = minY - 0.5
        this.maxYcor = maxY + 0.5
        this.minZcor = minZ - 0.5
        this.maxZcor = maxZ + 0.5

        // The midpoints of the world, in world coords.
        this.centerX = (minX + maxX) / 2
        this.centerY = (minY + maxY) / 2
        this.centerZ = (minZ + maxZ) / 2

        this.numPatches = this.numX * this.numY
    }

    /**
     * Return a random 2D point within the World
     *
     * @return {Array} A random x,y float array
     */
    randomPoint() {
        return [
            util.randomFloat2(this.minXcor, this.maxXcor),
            util.randomFloat2(this.minYcor, this.maxYcor),
        ]
    }

    /**
     * Return a random 3D point within the World
     *
     * @return {Array} A random x,y,z float array
     */
    random3DPoint() {
        return [
            util.randomFloat2(this.minXcor, this.maxXcor),
            util.randomFloat2(this.minYcor, this.maxYcor),
            util.randomFloat2(this.minZcor, this.maxZcor),
        ]
    }

    /**
     * Return a random Patch 2D integer point
     *
     * @return {Array}  A random x,y integer array
     */
    randomPatchPoint() {
        return [
            util.randomInt2(this.minX, this.maxX),
            util.randomInt2(this.minY, this.maxY),
        ]
    }

    /**
     * Given x,y,z values return true if within the world
     *
     * @param {number} x x value
     * @param {number} y y value
     * @param {number} [z=this.centerZ] z value
     * @return {boolean} Whether or not on-world
     */
    isOnWorld(x, y, z = this.centerZ) {
        return (
            this.minXcor &lt;= x &amp;&amp;
            x &lt;= this.maxXcor &amp;&amp;
            //
            this.minYcor &lt;= y &amp;&amp;
            y &lt;= this.maxYcor &amp;&amp;
            //
            this.minZcor &lt;= z &amp;&amp;
            z &lt;= this.maxZcor
        )
    }
    // cropToWorld(x, y) {}

    // Note minX etc NOT the world's but of the coord sys we want to use.
    /**
     * Return an instance of a bounding box 2D transform.
     * It linearly interpolates between the given minX, minY, maxX, maxY,
     * and the world's values of the same properties.
     *
     * The parameters are in the popular geojson order: west, south, east, north
     *
     * Useful for Canvas top-left transforms and geojson transforms.
     *
     * @param {number} minX min bounding box x value
     * @param {number} minY min bounding box y value
     * @param {number} maxX max bounding box x value
     * @param {number} maxY max bounding box y value
     * @return {BBoxTransform} Instance of the BBoxTransform
     */
    bboxTransform(minX, minY, maxX, maxY) {
        return new BBoxTransform(minX, minY, maxX, maxY, this)
    }

    // ### Following use PatchSize

    // Get the world size in pixels. PatchSize is optional, defalting to 1
    getWorldSize(patchSize = 1) {
        return [this.numX * patchSize, this.numY * patchSize]
    }

    // Convert a canvas context to world euclidean coordinates
    // Change the ctx.canvas size, determined by patchSize.
    setEuclideanTransform(ctx, patchSize) {
        // ctx.canvas.width = this.numX * patchSize
        // ctx.canvas.height = this.numY * patchSize
        this.setCanvasSize(ctx.canvas, patchSize)
        ctx.restore() // close earlier save(). OK if no save called yet.
        ctx.save()
        ctx.scale(patchSize, -patchSize)
        ctx.translate(-this.minXcor, -this.maxYcor)
    }
    // Return patch size for given canvas.
    // Error if canvas patch width/height differ.
    patchSize(canvas) {
        const { numX, numY } = this
        const { clientWidth: width, clientHeight: height } = canvas
        const xSize = width / numX
        const ySize = height / numY
        if (xSize !== ySize) {
            throw Error(`World patchSize: x/y sizes differ ${xSize}, ${ySize}`)
        }
        return xSize
    }
    // Change canvas size to this world's size.
    // Does not change size if already the same, preserving the ctx content.
    setCanvasSize(canvas, patchSize) {
        const [width, height] = this.getWorldSize(patchSize)
        util.setCanvasSize(canvas, width, height)
    }

    // Convert pixel location (top/left offset i.e. mouse) to patch coords (float)
    pixelXYtoPatchXY(x, y, patchSize) {
        return [this.minXcor + x / patchSize, this.maxYcor - y / patchSize]
    }
    // Convert patch coords (float) to pixel location (top/left offset i.e. mouse)
    patchXYtoPixelXY(x, y, patchSize) {
        return [(x - this.minXcor) * patchSize, (this.maxYcor - y) * patchSize]
    }

    xyToPatchIndex(x, y) {
        if (!this.isOnWorld(x, y)) return undefined
        const { minX, maxX, maxY, numX, maxXcor, maxYcor } = this
        x = x === maxXcor ? maxX : Math.round(x)
        y = y === maxYcor ? maxY : Math.round(y)
        return x - minX + numX * (maxY - y)
    }
    // patchIndexToXY(index) {}
}

/**
 * A linear transformer between world coords and the given bounding box.
 *
 * @class
 * @private
 */
class BBoxTransform {
    // geo bbox definition:
    //    https://tools.ietf.org/html/rfc7946#section-5
    //    [west, south, east, north]
    /**
     * Creates an instance of BBoxTransform.
     * @param {number} minX min bounding box x value
     * @param {number} minY max bounding box x value
     * @param {number} maxX min bounding box y value
     * @param {number} maxY max bounding box y value
     * @param {World} world instance of a World object
     */
    constructor(minX, minY, maxX, maxY, world) {
        if (minX &lt; maxX) console.log('flipX')
        if (maxY &lt; minY) console.log('flipY')

        if (minX &lt; maxX) [minX, maxX] = [maxX, minX]
        if (maxY &lt; minY) [maxY, minY] = [minY, maxY]
        const { maxXcor, maxYcor, minXcor, minYcor } = world

        const mx = (minX - maxX) / (maxXcor - minXcor)
        const my = (maxY - minY) / (maxYcor - minYcor)

        const bx = (minX + maxX - mx * (maxXcor + minXcor)) / 2
        const by = (maxY + minY - my * (maxYcor + minYcor)) / 2

        // Object.assign(this, { mx, my, bx, by })
        this.setClassProperties({ mx, my, bx, by })
    }
    setClassProperties(obj) {
        this.mx = obj.mx
        this.my = obj.my
        this.bx = obj.bx
        this.by = obj.by
    }

    /**
     * Convert from bbox point to world point
     *
     * @param {Array} bboxPoint A point in the bbox coordinates
     * @return {Array} A point in the world coordinates
     */
    toWorld(bboxPoint) {
        const { mx, my, bx, by } = this
        const [bboxX, bboxY] = bboxPoint
        const x = (bboxX - bx) / mx
        const y = (bboxY - by) / my
        return [x, y]
    }

    /**
     * Convert from world point to bbox point
     *
     * @param {Array} worldPoint A point in the world coordinates
     * @return {Array} A point in the bbox coordinates
     */
    toBBox(worldPoint) {
        const { mx, my, bx, by } = this
        const [worldX, worldY] = worldPoint
        const x = mx * worldX + bx
        const y = my * worldY + by
        return [x, y]
    }
}

export default World

// The midpoints of the world, in world coords.
// (0, 0) for the centered default worlds. REMIND: remove?
// this.centerX = (this.minX + this.maxX) / 2
// this.centerY = (this.minY + this.maxY) / 2

// Calculate patchSize from canvas (any imagable) dimensions
// canvasPatchSize(canvas) {
//     // const [width, height] = canvas
//     return canvas.width / this.numX
// }
// canvasSize(patchSize) {
//     return [this.numX * patchSize, this.numY * patchSize]
// }

// Other ways to specify class properties:
// maxX = 16
// maxY = 16
// maxZ = 16
// minX = -this.maxX
// minY = -this.maxY
// minZ = -this.maxZ

// Note: this is es7 class properties.
// /** @type {number} Max patch x value */ maxX = 16
// /** @type {number} */ maxY = this.maxX
// /** @type {number} */ maxZ = Math.max(this.maxX, this.maxY)
// /** @type {number} */ minX = -this.maxX
// /** @type {number} */ minY = -this.maxY
// /** @type {number} */ minZ = -this.maxZ

//  * @property {number} maxX = 16
//  * @property {number} maxY = this.maxX
//  * @property {number} maxZ = Math.max(this.maxX, this.maxY)
//  * @property {number} minX = -this.maxX
//  * @property {number} minY = -this.maxY
//  * @property {number} minZ = -this.maxZ

// Note: this is es7 class properties.
// /** @type {number} */ mx
// /** @type {number} */ my
// /** @type {number} */ bx
// /** @type {number} */ by
</code></pre>
        </article>
    </section>




</div>

<footer id="footer">
  
</footer>

<script src="scripts/third-party/prettify.js"></script>
<script src="scripts/third-party/lang-css.js"></script>
<script src="scripts/search.js"></script>
<script src="scripts/third-party/fuse.js"></script>
<script type="text/javascript" src="scripts/misc.js"></script>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/fix-code-block.js"></script>
<script>
  var list = [{"title":"01-HelloModel","link":"01-HelloModel"},{"title":"02-HelloHtml","link":"02-HelloHtml"},{"title":"03-HelloServer","link":"03-HelloServer"},{"title":"04-HelloView","link":"04-HelloView"},{"title":"JavaScript","link":"JavaScript"},{"title":"AgentArray","link":"<a href=\"AgentArray.html\">AgentArray</a>"},{"title":"AgentArray.fromArray","link":"<a href=\"AgentArray.html#.fromArray\">AgentArray.fromArray &rtrif; undefined</a>"},{"title":"AgentArray#all","link":"<a href=\"AgentArray.html#all\">AgentArray &rtrif; all</a>"},{"title":"AgentArray#ask","link":"<a href=\"AgentArray.html#ask\">AgentArray &rtrif; ask</a>"},{"title":"AgentArray#atIndex","link":"<a href=\"AgentArray.html#atIndex\">AgentArray &rtrif; atIndex</a>"},{"title":"AgentArray#clone","link":"<a href=\"AgentArray.html#clone\">AgentArray &rtrif; clone</a>"},{"title":"AgentArray#first","link":"<a href=\"AgentArray.html#first\">AgentArray &rtrif; first</a>"},{"title":"AgentArray#forLoop","link":"<a href=\"AgentArray.html#forLoop\">AgentArray &rtrif; forLoop</a>"},{"title":"AgentArray#isEmpty","link":"<a href=\"AgentArray.html#isEmpty\">AgentArray &rtrif; isEmpty</a>"},{"title":"AgentArray#last","link":"<a href=\"AgentArray.html#last\">AgentArray &rtrif; last</a>"},{"title":"AgentArray#props","link":"<a href=\"AgentArray.html#props\">AgentArray &rtrif; props</a>"},{"title":"AgentArray#sortBy","link":"<a href=\"AgentArray.html#sortBy\">AgentArray &rtrif; sortBy</a>"},{"title":"AgentArray#toArray","link":"<a href=\"AgentArray.html#toArray\">AgentArray &rtrif; toArray</a>"},{"title":"AgentArray#typedSample","link":"<a href=\"AgentArray.html#typedSample\">AgentArray &rtrif; typedSample</a>"},{"title":"AgentArray#uniq","link":"<a href=\"AgentArray.html#uniq\">AgentArray &rtrif; uniq</a>"},{"title":"AgentArray#with","link":"<a href=\"AgentArray.html#with\">AgentArray &rtrif; with</a>"},{"title":"AgentSet","link":"<a href=\"AgentSet.html\">AgentSet</a>"},{"title":"AgentSet#addAgent","link":"<a href=\"AgentSet.html#addAgent\">AgentSet &rtrif; addAgent</a>"},{"title":"AgentSet#ask","link":"<a href=\"AgentSet.html#ask\">AgentSet &rtrif; ask</a>"},{"title":"AgentSet#askSet","link":"<a href=\"AgentSet.html#askSet\">AgentSet &rtrif; askSet</a>"},{"title":"AgentSet#clear","link":"<a href=\"AgentSet.html#clear\">AgentSet &rtrif; clear</a>"},{"title":"AgentSet#getDefault","link":"<a href=\"AgentSet.html#getDefault\">AgentSet &rtrif; getDefault</a>"},{"title":"AgentSet#isBaseSet","link":"<a href=\"AgentSet.html#isBaseSet\">AgentSet &rtrif; isBaseSet</a>"},{"title":"AgentSet#isBreedSet","link":"<a href=\"AgentSet.html#isBreedSet\">AgentSet &rtrif; isBreedSet</a>"},{"title":"AgentSet#newBreed","link":"<a href=\"AgentSet.html#newBreed\">AgentSet &rtrif; newBreed</a>"},{"title":"AgentSet#protoMixin","link":"<a href=\"AgentSet.html#protoMixin\">AgentSet &rtrif; protoMixin</a>"},{"title":"AgentSet#removeAgent","link":"<a href=\"AgentSet.html#removeAgent\">AgentSet &rtrif; removeAgent</a>"},{"title":"AgentSet#setBreed","link":"<a href=\"AgentSet.html#setBreed\">AgentSet &rtrif; setBreed</a>"},{"title":"AgentSet#setDefault","link":"<a href=\"AgentSet.html#setDefault\">AgentSet &rtrif; setDefault</a>"},{"title":"AgentSet#withBreed","link":"<a href=\"AgentSet.html#withBreed\">AgentSet &rtrif; withBreed</a>"},{"title":"DataSet","link":"<a href=\"DataSet.html\">DataSet</a>"},{"title":"DataSet.emptyDataSet","link":"<a href=\"DataSet.html#.emptyDataSet\">DataSet.emptyDataSet &rtrif; undefined</a>"},{"title":"Link","link":"<a href=\"Link.html\">Link</a>"},{"title":"Links","link":"<a href=\"Links.html\">Links</a>"},{"title":"Model","link":"<a href=\"Model.html\">Model</a>"},{"title":"Model#linkBreeds","link":"<a href=\"Model.html#linkBreeds\">Model &rtrif; linkBreeds</a>"},{"title":"Model#patchBreeds","link":"<a href=\"Model.html#patchBreeds\">Model &rtrif; patchBreeds</a>"},{"title":"Model#reset","link":"<a href=\"Model.html#reset\">Model &rtrif; reset</a>"},{"title":"Model#setup","link":"<a href=\"Model.html#setup\">Model &rtrif; setup</a>"},{"title":"Model#startup","link":"<a href=\"Model.html#startup\">Model &rtrif; startup</a>"},{"title":"Model#step","link":"<a href=\"Model.html#step\">Model &rtrif; step</a>"},{"title":"Model#tick","link":"<a href=\"Model.html#tick\">Model &rtrif; tick</a>"},{"title":"Model#turtleBreeds","link":"<a href=\"Model.html#turtleBreeds\">Model &rtrif; turtleBreeds</a>"},{"title":"Patch","link":"<a href=\"Patch.html\">Patch</a>"},{"title":"Patches","link":"<a href=\"Patches.html\">Patches</a>"},{"title":"Patches#exportDataSet","link":"<a href=\"Patches.html#exportDataSet\">Patches &rtrif; exportDataSet</a>"},{"title":"Patches#importDataSet","link":"<a href=\"Patches.html#importDataSet\">Patches &rtrif; importDataSet</a>"},{"title":"Patches#neighbors","link":"<a href=\"Patches.html#neighbors\">Patches &rtrif; neighbors</a>"},{"title":"Patches#neighbors4","link":"<a href=\"Patches.html#neighbors4\">Patches &rtrif; neighbors4</a>"},{"title":"Patches#patchIndex","link":"<a href=\"Patches.html#patchIndex\">Patches &rtrif; patchIndex</a>"},{"title":"Turtle","link":"<a href=\"Turtle.html\">Turtle</a>"},{"title":"Turtles","link":"<a href=\"Turtles.html\">Turtles</a>"},{"title":"Turtles#addAgent","link":"<a href=\"Turtles.html#addAgent\">Turtles &rtrif; addAgent</a>"},{"title":"Turtles#ask","link":"<a href=\"Turtles.html#ask\">Turtles &rtrif; ask</a>"},{"title":"Turtles#askSet","link":"<a href=\"Turtles.html#askSet\">Turtles &rtrif; askSet</a>"},{"title":"Turtles#clear","link":"<a href=\"Turtles.html#clear\">Turtles &rtrif; clear</a>"},{"title":"Turtles#getDefault","link":"<a href=\"Turtles.html#getDefault\">Turtles &rtrif; getDefault</a>"},{"title":"Turtles#inPatches","link":"<a href=\"Turtles.html#inPatches\">Turtles &rtrif; inPatches</a>"},{"title":"Turtles#isBaseSet","link":"<a href=\"Turtles.html#isBaseSet\">Turtles &rtrif; isBaseSet</a>"},{"title":"Turtles#isBreedSet","link":"<a href=\"Turtles.html#isBreedSet\">Turtles &rtrif; isBreedSet</a>"},{"title":"Turtles#newBreed","link":"<a href=\"Turtles.html#newBreed\">Turtles &rtrif; newBreed</a>"},{"title":"Turtles#protoMixin","link":"<a href=\"Turtles.html#protoMixin\">Turtles &rtrif; protoMixin</a>"},{"title":"Turtles#removeAgent","link":"<a href=\"Turtles.html#removeAgent\">Turtles &rtrif; removeAgent</a>"},{"title":"Turtles#setBreed","link":"<a href=\"Turtles.html#setBreed\">Turtles &rtrif; setBreed</a>"},{"title":"Turtles#setDefault","link":"<a href=\"Turtles.html#setDefault\">Turtles &rtrif; setDefault</a>"},{"title":"Turtles#withBreed","link":"<a href=\"Turtles.html#withBreed\">Turtles &rtrif; withBreed</a>"},{"title":"World","link":"<a href=\"World.html\">World</a>"},{"title":"World.defaultOptions","link":"<a href=\"World.html#.defaultOptions\">World.defaultOptions &rtrif; undefined</a>"},{"title":"World.defaultWorld","link":"<a href=\"World.html#.defaultWorld\">World.defaultWorld &rtrif; undefined</a>"},{"title":"World#bboxTransform","link":"<a href=\"World.html#bboxTransform\">World &rtrif; bboxTransform</a>"},{"title":"World#isOnWorld","link":"<a href=\"World.html#isOnWorld\">World &rtrif; isOnWorld</a>"},{"title":"World#random3DPoint","link":"<a href=\"World.html#random3DPoint\">World &rtrif; random3DPoint</a>"},{"title":"World#randomPatchPoint","link":"<a href=\"World.html#randomPatchPoint\">World &rtrif; randomPatchPoint</a>"},{"title":"World#randomPoint","link":"<a href=\"World.html#randomPoint\">World &rtrif; randomPoint</a>"}];
  var options = 
  setupSearch(list, options)
</script>

 






</body>
</html>
